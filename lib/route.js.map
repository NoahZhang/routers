{"version":3,"sources":["..\\dist\\route.js"],"names":[],"mappings":";;;;;;;;;;uBAAoB,aAAa;;;;4BACR,gBAAgB;;;;4BAChB,eAAe;;;;IAEnB,KAAK;AACb,WADQ,KAAK,CACZ,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE;;;0BADhC,KAAK;;AAEtB,QAAI,CAAC,IAAI,GAAG,IAAI,IAAI,IAAI,CAAC;AACzB,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,QAAI,CAAC,OAAO,GAAG,EAAE,CAAC;AAClB,WAAO,CAAC,OAAO,CAAC,UAAA,MAAM,EAAI;AACxB,UAAI,CAAC,GAAG,MAAK,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;AAChD,UAAG,MAAK,OAAO,CAAC,CAAC,GAAC,CAAC,CAAC,KAAK,KAAK,EAAE;AAC9B,cAAK,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;OAC9B;KACF,EAAE,IAAI,CAAC,CAAC;;AAET,QAAI,CAAC,UAAU,GAAG,EAAE,CAAC;;AAErB,QAAI,CAAC,GAAG,GAAG;AACT,YAAM,EAAC,EAAE;AACT,gBAAU,EAAC,EAAE;KACd,CAAC;;AAEF,QAAI,IAAI,YAAY,MAAM,EAAE;AAC1B,UAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACpB,MAAM;AACL,UAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,UAAI,CAAC,MAAM,GAAG,uBAAa,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;KACzD;;AAED,cAAU,CAAC,OAAO,CAAC,UAAA,EAAE,EAAI;AACvB,UAAI,IAAI,GAAI,OAAO,EAAE,AAAC,CAAC;AACvB,UAAI,IAAI,KAAK,UAAU,EAAE;AACvB,cAAM,IAAI,KAAK,CACb,OAAO,CAAC,QAAQ,EAAE,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,CAAA,AAAC,GAAG,kBAAkB,GAC7D,2BAA2B,GAAG,IAAI,GAAG,GAAG,CAC3C,CAAC;OACH;KACF,CAAC,CAAC;;AAEH,QAAI,CAAC,UAAU,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,GAAG,kBAAQ,UAAU,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;;AAE9E,QAAI,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC;GAClC;;eAvCkB,KAAK;;WAyCnB,eAAC,IAAI,EAAE;AACV,aAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC/B;;;WAEsB,gCAAC,IAAI,EAAE;AAC5B,UAAI;AACF,eAAO,kBAAkB,CAAC,IAAI,CAAC,CAAC;OACjC,CAAC,OAAO,CAAC,EAAE;AACV,eAAO,IAAI,CAAC;OACb;KACF;;;;;;;;;;;;;OAEK,UAAC,IAAI,EAAE,QAAQ,EAAE;AACrB,UAAI,MAAM,GAAG,EAAE,CAAC;;AAEhB,WAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,GAAG,EAAE,CAAC,EAAE,EAAE;AAC9C,YAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;AACrB,cAAI,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AACpB,gBAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;SAC1E;OACF;;AAED,aAAO,MAAM,CAAC;KACf;;;WAEO,kBAAC,IAAI,EAAE;AACb,aAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KACzC;;;;;;;;;;;;;OAEE,UAAC,MAAM,EAAE;AACV,UAAI,IAAI,GAAG,MAAM,CAAC;AAClB,UAAI,GAAG,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;;AAE1C,UAAI,OAAO,MAAM,IAAI,QAAQ,EAAE;AAC7B,YAAI,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;OAC9C;;AAED,UAAI,IAAI,YAAY,KAAK,EAAE;AACzB,aAAI,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAC5C,aAAG,GAAG,GAAG,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;SACvC;OACF,MAAM;AACL,aAAI,IAAI,GAAG,IAAI,IAAI,EAAE;AACnB,aAAG,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;SACzC;OACF;;AAED,SAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,SAAS,EAAI;AAClC,WAAG,GAAG,GAAG,CAAC,OAAO,CAAC,SAAS,EAAE,kBAAkB,CAAC,SAAS,CAAC,CAAC,CAAC;OAC7D,CAAC,CAAC;;AAEH,aAAO,GAAG,CAAC;KACZ;;;;;;;;;;;;;OAEI,UAAC,KAAK,EAAE,EAAE,EAAE;;;AACf,UAAI,UAAU,GAAG,EAAE,CAAC;;AAEpB,UAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,WAAW,IAAI,EAAE;AACxC,eAAO,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;OAChD,CAAA;;AAED,UAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,KAAK,EAAI;AAC/B,YAAI,EAAE,GAAG,OAAK,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACrC,YAAG,EAAE,EAAE;AACL,oBAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACrB;OACF,EAAE,IAAI,CAAC,CAAC;;AAET,UAAI,CAAC,UAAU,GAAG,kBAAQ,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;;AAElE,aAAO,IAAI,CAAC;KACb;;;WAEQ,mBAAC,MAAM,EAAE;AAChB,UAAG,IAAI,CAAC,IAAI,EAAE;AACZ,YAAI,CAAC,IAAI,GAAG,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC;AAC/B,YAAI,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,YAAI,CAAC,MAAM,GAAG,uBAAa,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;OACnE,MAAM;AACL,YAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;AAChC,YAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,GAAG,GAAG,GAAG,EAAE,CAAC;AAC9C,YAAI,IAAI,GAAG,IAAI,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;AACxD,cAAM,GAAG,IAAI,MAAM,CAAC,CAAC,GAAG,GAAG,MAAM,CAAA,CAAE,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;AAC1D,YAAI,CAAC,MAAM,GAAG,uBAAa,MAAM,EAAE,IAAI,CAAC,CAAC;OAC1C;;AAED,aAAO,IAAI,CAAC;KACb;;;SAhIkB,KAAK;;;kBAAL,KAAK","file":"dist/route.js","sourcesContent":["import compose from 'koa-compose'\r\nimport pathToRegExp from 'path-to-regexp'\r\nimport concatRegExp from 'concat-regexp'\r\n\r\nexport default class Route{\r\n  constructor(path, methods, middleware, name, opts) {\r\n    this.name = name || null;\r\n    this.opts = opts;\r\n    this.methods = [];\r\n    methods.forEach(method => {\r\n      var l = this.methods.push(method.toUpperCase());\r\n      if(this.methods[l-1] === 'GET') {\r\n        this.methods.unshift('HEAD');\r\n      }\r\n    }, this);\r\n\r\n    this.paramNames = [];\r\n\r\n    this.fns = {\r\n      params:{},\r\n      middleware:[]\r\n    };\r\n\r\n    if (path instanceof RegExp) {\r\n      this.regexp = path;\r\n    } else {\r\n      this.path = path;\r\n      this.regexp = pathToRegExp(path, this.paramNames, opts);\r\n    }\r\n\r\n    middleware.forEach(fn => {\r\n      var type = (typeof fn);\r\n      if (type !== 'function') {\r\n        throw new Error(\r\n          methods.toString() + \" `\" + (name || path) + \"`: `middleware` \"\r\n          + \"must be a function, not `\" + type + \"`\"\r\n        );\r\n      }\r\n    });\r\n\r\n    this.middleware = middleware.length > 1 ? compose(middleware) : middleware[0];\r\n\r\n    this.fns.middleware = middleware;\r\n  }\r\n\r\n  match(path) {\r\n    return this.regexp.test(path);\r\n  }\r\n\r\n   safeDecodeURIComponent(text) {\r\n    try {\r\n      return decodeURIComponent(text);\r\n    } catch (e) {\r\n      return text;\r\n    }\r\n  }\r\n\r\n  params(path, captures) {\r\n    var params = {};\r\n\r\n    for(let len = captures.length, i=0; i<len; i++) {\r\n      if(this.paramNames[i]) {\r\n        var c = captures[i];\r\n        params[this.paramNames[i].name] = c ? this.safeDecodeURIComponent(c) : c;\r\n      }\r\n    }\r\n\r\n    return params;\r\n  }\r\n\r\n  captures(path) {\r\n    return path.match(this.regexp).slice(1);\r\n  }\r\n\r\n  url(params) {\r\n    var args = params;\r\n    var url = this.path || this.regexp.source;\r\n\r\n    if (typeof params != 'object') {\r\n      args = Array.prototype.slice.call(arguments);\r\n    }\r\n\r\n    if (args instanceof Array) {\r\n      for(let len = args.length, i=0; i < len; i++) {\r\n        url = url.replace(/:[^\\/]+/, args[i]);\r\n      }\r\n    } else {\r\n      for(let key in args) {\r\n        url = url.replace(':' + key, args[key]);\r\n      }\r\n    }\r\n\r\n    url.split('/').forEach(component => {\r\n      url = url.replace(component, encodeURIComponent(component));\r\n    });\r\n\r\n    return url;\r\n  }\r\n\r\n  param(param, fn) {\r\n    var middleware = [];\r\n\r\n    this.fns.params[param] = function *(next) {\r\n      yield *fn.call(this, this.params[param], next);\r\n    }\r\n\r\n    this.paramNames.forEach(param => {\r\n      var fn = this.fns.params[param.name];\r\n      if(fn) {\r\n        middleware.push(fn);\r\n      }\r\n    }, this);\r\n\r\n    this.middleware = compose(middleware.concat(this.fns.middleware));\r\n\r\n    return this;\r\n  }\r\n\r\n  setPrefix(prefix) {\r\n    if(this.path) {\r\n      this.path = prefix + this.path;\r\n      this.paramNames = [];\r\n      this.regexp = pathToRegExp(this.path, this.paramNames, this.opts);\r\n    } else {\r\n      var source = this.regexp.source;\r\n      var flags = this.regexp.ignoreCase ? 'i' : '';\r\n      var path = new RegExp(source.replace(/^\\^/, ''), flags);\r\n      prefix = new RegExp(('^' + prefix).replace(/\\//g, '\\\\/'));\r\n      this.regexp = concatRegExp(prefix, path);\r\n    }\r\n\r\n    return this;\r\n  }\r\n}\r\n"]}